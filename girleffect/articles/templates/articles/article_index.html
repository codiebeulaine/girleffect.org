{% extends "base.html" %}
{% load wagtailcore_tags wagtailimages_tags static %}

{% block content %}
    <section class="hero">
        <h1 class="hero__heading">{% if page.heading %}{{ page.heading }}{% else %}{{ page.title }}{% endif %}</h1>
    </section>

    {# Intro is RichText #}
    {{ page.introduction|richtext }}

    <section class="wrapper wrapper--medium">
        <section class="listing">
            <form method="GET">
                <select name="category">
                    <option value="">All</option>
                    {% for category in categories %}
                        <option value="{{ category.0 }}" {% if request.GET.category == category.0|slugify %}selected="selected"{% endif %}>{{ category.1 }}</option>
                    {% endfor %}
                </select>
            </form>

            {% if articles %}

                <section class="section section--articles">
                    <div class="article-container wrapper wrapper--medium grid grid--three">
                        {% for article in articles %}
                            <div class="article-card__copy">
                                <a class="article-card__link" href="{% pageurl article %}">
                                    {% if article.listing_image %}
                                        {% image article.listing_image fill-450x300 %}
                                    {% endif %}

                                    {% if article.listing_title %}
                                        <div>{{ article.listing_title }}</div>
                                    {% else %}
                                        <div>{{ article.title }}</div>
                                    {% endif %}
                                </a>
                                <span class="article-card__date">{{ article.display_date }}</span>
                                {% if article.listing_summary %}
                                    <p>{{ article.listing_summary }}</p>
                                {% endif %}
                            </div>
                        {% endfor %}
                    </div>
                </section>

                {% include "includes/pagination.html" %}
            {% else %}
                {# no items #}
            {% endif %}
        </section>
    </section>
{% endblock %}
